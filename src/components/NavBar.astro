---
// Astro
import { Image } from "astro:assets";

// Assets
import logo from "../assets/images/logo.svg";
import HamburgerIcon from "../assets/icons/HamburgerIcon.astro";
import AboutUsIcon from "../assets/icons/nav/AboutUsIcon.astro";
import PortfolioIcon from "../assets/icons/nav/PortfolioIcon.astro";
import ServiceIcon from "../assets/icons/nav/ServiceIcon.astro";

const currentPath = Astro.url.pathname;
---

<nav
  class="sticky top-0 left-0 py-4 px-6 bg-gray-custom transition-colors backdrop-blur-sm overflow-visible lg:px-8 z-50"
  id="nav"
>
  <div class="flex items-center justify-between">
    <a
      href="/"
      aria-label="Ir a la página principal"
      class="w-32 z-20 hover:scale-105 transition-transform"
    >
      <Image src={logo} alt="HighQ Logo" loading="eager" />
    </a>
    <ul
      id="menu"
      class="absolute top-0 right-0 w-full h-screen bg-gray-custom pt-28 flex flex-col [clip-path:_circle(0.0%_at_100%_0)] transition-[clip-path] duration-300 ease-in-out md:static md:[clip-path:_none] md:w-auto md:h-auto md:bg-transparent md:flex-row md:pt-0 md:text-sm md:gap-10 md:items-center"
    >
      <li>
        <a
          href="/sobre_nosotros"

          class={`group flex justify-between items-center text-white pl-8 uppercase bg-transparent hover:bg-white/5 hover:scale-95 transition md:pl-0 md:hover:text-green-custom md:hover:bg-transparent md:hover:scale-105 ${
            currentPath === "/sobre-nosotros"
              ? "md:text-green-custom md:bg-transparent bg-white/5 scale-95"
              : ""
          }`}
        >
          Sobre Nosotros
          <div
            class={`bg-blue-custom size-16 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity md:hidden ${
              currentPath === "/sobre-nosotros" ? "opacity-100" : ""
            }`}
          >
            <AboutUsIcon class="size-10 text-white" />
          </div>
        </a>
      </li>
      <li>
        <a
          href="/portafolio"
          class={`group flex justify-between items-center text-white pl-8 uppercase bg-transparent hover:bg-white/5 hover:scale-95 transition md:pl-0 md:hover:text-green-custom md:hover:bg-transparent md:hover:scale-105 ${
            currentPath === "/portafolio"
              ? "md:text-green-custom md:bg-transparent bg-white/5 scale-95"
              : ""
          }`}
        >
          Portafolio
          <div
            class={`bg-blue-custom size-16 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity md:hidden ${
              currentPath === "/portafolio" ? "opacity-100" : ""
            }`}
          >
            <PortfolioIcon class="size-10 text-white" />
          </div>
        </a>
      </li>
      <li>
        <a
          href="/servicios"
          class={`group flex justify-between items-center text-white pl-8 uppercase bg-transparent hover:bg-white/5 hover:scale-95 transition md:pl-0 md:hover:text-green-custom md:hover:bg-transparent md:hover:scale-105 ${
            currentPath === "/servicios"
              ? "md:text-green-custom md:bg-transparent bg-white/5 scale-95"
              : ""
          }`}
        >
          Servicios
          <div
            class={`bg-blue-custom size-16 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity md:hidden ${
              currentPath === "/servicios" ? "opacity-100" : ""
            }`}
          >
            <ServiceIcon class="size-10 text-white" />
          </div>
        </a>
      </li>
      <li>
        <a
          href="/contactar"
          class="uppercase font-medium text-sm hidden md:block p-2 border-2 border-green-custom text-white rounded-md hover:bg-green-custom hover:scale-105 transition"
        >
          Contactar
        </a>
      </li>
    </ul>
    <button
      type="button"
      aria-label="Mostrar/Ocultar mennú de navegación"
      class="relative z-20 cursor-pointer rounded-md hover:scale-105 active:bg-white/10 transition md:hidden z-50"
      id="menu-toggle"
    >
      <HamburgerIcon class="size-8 text-white" />
    </button>
  </div>
</nav>

<script>
  const menu = document.getElementById("menu");
  const hamburger = document.getElementById("menu-toggle");
  const nav = document.getElementById("nav");

  if (!menu || !hamburger || !nav)
    throw new Error("Missing menu, hamburger, or nav element");

  hamburger.addEventListener("click", () => {
    menu.classList.toggle("[clip-path:_circle(0.0%_at_100%_0)]");
    menu.classList.toggle("[clip-path:_circle(141.2%_at_100%_0)]");
  });

  window.addEventListener("scroll", () => {
    if (window.scrollY > 50) {
      nav.classList.remove("bg-gray-custom");
      nav.classList.add("bg-gray-custom/30");
    } else {
      nav.classList.remove("bg-gray-custom/30");
      nav.classList.add("bg-gray-custom");
    }
  });
</script>