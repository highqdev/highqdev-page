---
import { Image } from "astro:assets";
import logo from "../assets/images/logo.svg";
import HamburgerIcon from "../assets/icons/HamburgerIcon.astro";

const links = [
  { href: "/sobre-nosotros", label: "Sobre Nosotros" },
  { href: "/portfolio", label: "Portafolio" },
  { href: "/servicios", label: "Servicios" },
];

const currentPath = Astro.url.pathname;
---

<nav
  class="sticky top-0 left-0 py-4 px-6 bg-gray-custom transition-colors backdrop-blur-sm overflow-visible lg:px-8"
  id="nav"
>
  <div class="flex items-center justify-between">
    <a
      href="/"
      aria-label="Ir a la página principal"
      class="w-32 z-20 hover:scale-105 transition-transform"
    >
      <Image src={logo} alt="HighQ Logo" loading="eager" />
    </a>
    <ul
      class="absolute top-0 left-0 w-full h-screen flex items-center justify-center flex-col gap-4 bg-gray-custom [clip-path:_circle(0.0%_at_50%_50%)] transition-[clip-path] duration-300 ease-in-out md:static md:[clip-path:_none] md:w-auto md:h-auto md:bg-transparent md:gap-6 md:flex-row md:justify-between"
      id="menu"
    >
      {
        links.map((link) => (
          <li>
            <a
              href={link.href}
              class={`${currentPath === link.href ? "text-green-custom" : "text-white hover:text-green-custom"} uppercase font-medium transition-colors md:text-sm`}
            >
              {link.label}
            </a>
          </li>
        ))
      }
      <li>
        <a
          href="/contactar"
          class="uppercase font-medium text-sm hidden md:block p-2 border-2 border-green-custom text-white rounded-md hover:bg-green-custom hover:scale-105 transition"
        >
          Contactar
        </a>
      </li>
    </ul>
    <button
      type="button"
      aria-label="Mostrar/Ocultar mennú de navegación"
      class="relative z-20 cursor-pointer md:hidden"
      id="menu-toggle"
    >
      <HamburgerIcon class="size-8 text-white" />
    </button>
  </div>
</nav>

<script>
  const menu = document.getElementById("menu");
  const hamburger = document.getElementById("menu-toggle");
  const nav = document.getElementById("nav");

  if (!menu || !hamburger || !nav)
    throw new Error("Missing menu, hamburger, or nav element");

  hamburger.addEventListener("click", () => {
    menu.classList.toggle("[clip-path:_circle(0.0%_at_50%_50%)]");
    menu.classList.toggle("[clip-path:_circle(70.7%_at_50%_50%)]");
  });

  window.addEventListener("scroll", () => {
    if (window.scrollY > 50) {
      nav.classList.remove("bg-gray-custom");
      nav.classList.add("bg-gray-custom/30");
    } else {
      nav.classList.remove("bg-gray-custom/30");
      nav.classList.add("bg-gray-custom");
    }
  });
</script>
